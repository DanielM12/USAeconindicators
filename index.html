<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>USA Economic Indicators Dashboard</title>
    <style>
        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
        }

        body {
            font-family: -apple-system, BlinkMacSystemFont, 'Segoe UI', Roboto, Oxygen, Ubuntu, sans-serif;
            background: linear-gradient(135deg, #1a1a2e 0%, #16213e 100%);
            min-height: 100vh;
            color: #e0e0e0;
            padding: 20px;
        }

        .container {
            max-width: 1400px;
            margin: 0 auto;
        }

        header {
            text-align: center;
            padding: 30px 0;
            border-bottom: 1px solid rgba(255,255,255,0.1);
            margin-bottom: 30px;
        }

        h1 {
            font-size: 2.5rem;
            color: #fff;
            margin-bottom: 10px;
        }

        .subtitle {
            color: #888;
            font-size: 1.1rem;
        }

        .reminder-banner {
            background: linear-gradient(90deg, #ff6b6b, #ee5a5a);
            color: white;
            padding: 15px 25px;
            border-radius: 10px;
            margin-bottom: 30px;
            display: flex;
            align-items: center;
            gap: 15px;
            box-shadow: 0 4px 15px rgba(238, 90, 90, 0.3);
        }

        .reminder-banner .icon {
            font-size: 1.5rem;
        }

        .reminder-banner strong {
            display: block;
            margin-bottom: 3px;
        }

        .last-updated {
            text-align: right;
            color: #666;
            font-size: 0.9rem;
            margin-bottom: 20px;
        }

        .indicators-grid {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(400px, 1fr));
            gap: 25px;
            margin-bottom: 40px;
        }

        .indicator-card {
            background: rgba(255,255,255,0.05);
            border-radius: 15px;
            padding: 25px;
            border: 1px solid rgba(255,255,255,0.1);
            transition: transform 0.3s ease, box-shadow 0.3s ease;
        }

        .indicator-card:hover {
            transform: translateY(-5px);
            box-shadow: 0 10px 30px rgba(0,0,0,0.3);
        }

        .indicator-header {
            display: flex;
            justify-content: space-between;
            align-items: flex-start;
            margin-bottom: 20px;
        }

        .indicator-title {
            font-size: 1.2rem;
            color: #fff;
            font-weight: 600;
        }

        .indicator-badge {
            font-size: 0.75rem;
            padding: 4px 10px;
            border-radius: 20px;
            font-weight: 500;
        }

        .badge-quarterly {
            background: rgba(52, 152, 219, 0.2);
            color: #3498db;
        }

        .badge-weekly {
            background: rgba(46, 204, 113, 0.2);
            color: #2ecc71;
        }

        .badge-daily {
            background: rgba(155, 89, 182, 0.2);
            color: #9b59b6;
        }

        .indicator-value {
            font-size: 2.5rem;
            font-weight: 700;
            color: #fff;
            margin-bottom: 5px;
        }

        .indicator-change {
            font-size: 0.95rem;
            margin-bottom: 15px;
        }

        .change-up {
            color: #e74c3c;
        }

        .change-down {
            color: #2ecc71;
        }

        .change-neutral {
            color: #888;
        }

        .indicator-meta {
            display: flex;
            flex-direction: column;
            gap: 8px;
            padding-top: 15px;
            border-top: 1px solid rgba(255,255,255,0.1);
            font-size: 0.85rem;
            color: #888;
        }

        .meta-row {
            display: flex;
            justify-content: space-between;
        }

        .indicator-source a {
            color: #3498db;
            text-decoration: none;
        }

        .indicator-source a:hover {
            text-decoration: underline;
        }

        .indicator-chart {
            height: 80px;
            margin: 15px 0;
            background: rgba(255,255,255,0.03);
            border-radius: 8px;
            display: flex;
            align-items: stretch;
            padding: 10px;
            gap: 0;
        }

        .chart-y-axis {
            display: flex;
            flex-direction: column;
            justify-content: space-between;
            align-items: flex-end;
            padding-right: 6px;
            min-width: 40px;
            font-size: 0.65rem;
            color: #888;
        }

        .chart-y-axis span {
            line-height: 1;
        }

        .chart-bars {
            flex: 1;
            display: flex;
            align-items: flex-end;
            gap: 3px;
            border-left: 1px solid rgba(255,255,255,0.15);
            padding-left: 6px;
        }

        .chart-bar {
            flex: 1;
            background: linear-gradient(180deg, #3498db, #2980b9);
            border-radius: 3px 3px 0 0;
            min-height: 5px;
            transition: height 0.3s ease;
        }

        .loading {
            color: #888;
            font-style: italic;
        }

        .error {
            color: #e74c3c;
        }

        .data-sources {
            background: rgba(255,255,255,0.03);
            border-radius: 15px;
            padding: 30px;
            margin-top: 20px;
        }

        .data-sources h2 {
            color: #fff;
            margin-bottom: 20px;
            font-size: 1.3rem;
        }

        .sources-list {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(300px, 1fr));
            gap: 15px;
        }

        .source-item {
            display: flex;
            align-items: center;
            gap: 12px;
            padding: 12px 15px;
            background: rgba(255,255,255,0.05);
            border-radius: 8px;
        }

        .source-icon {
            width: 40px;
            height: 40px;
            background: rgba(52, 152, 219, 0.2);
            border-radius: 8px;
            display: flex;
            align-items: center;
            justify-content: center;
            font-size: 1.2rem;
        }

        .source-info a {
            color: #3498db;
            text-decoration: none;
            font-weight: 500;
        }

        .source-info a:hover {
            text-decoration: underline;
        }

        .source-info span {
            display: block;
            font-size: 0.8rem;
            color: #666;
            margin-top: 3px;
        }

        footer {
            text-align: center;
            padding: 30px 0;
            margin-top: 40px;
            border-top: 1px solid rgba(255,255,255,0.1);
            color: #666;
            font-size: 0.9rem;
        }

        .refresh-btn {
            background: linear-gradient(90deg, #3498db, #2980b9);
            color: white;
            border: none;
            padding: 12px 25px;
            border-radius: 8px;
            cursor: pointer;
            font-size: 1rem;
            margin-top: 20px;
            transition: transform 0.2s ease;
        }

        .refresh-btn:hover {
            transform: scale(1.05);
        }

        .refresh-btn:disabled {
            opacity: 0.6;
            cursor: not-allowed;
        }

        /* Reading Guide Styles */
        .reading-guide {
            background: rgba(255,255,255,0.03);
            border-radius: 15px;
            padding: 25px 30px;
            margin-bottom: 30px;
            border: 1px solid rgba(255,255,255,0.1);
        }

        .reading-guide h2 {
            color: #fff;
            font-size: 1.3rem;
            margin-bottom: 20px;
            display: flex;
            align-items: center;
            gap: 10px;
        }

        .guide-grid {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(280px, 1fr));
            gap: 15px;
        }

        .guide-item {
            background: rgba(255,255,255,0.03);
            border-radius: 10px;
            padding: 15px;
            border-left: 3px solid #3498db;
        }

        .guide-item h3 {
            color: #fff;
            font-size: 0.95rem;
            margin-bottom: 8px;
        }

        .guide-ranges {
            display: flex;
            flex-wrap: wrap;
            gap: 6px;
            font-size: 0.8rem;
        }

        .range-healthy {
            background: rgba(46, 204, 113, 0.2);
            color: #2ecc71;
            padding: 3px 8px;
            border-radius: 4px;
        }

        .range-warning {
            background: rgba(241, 196, 15, 0.2);
            color: #f1c40f;
            padding: 3px 8px;
            border-radius: 4px;
        }

        .range-danger {
            background: rgba(231, 76, 60, 0.2);
            color: #e74c3c;
            padding: 3px 8px;
            border-radius: 4px;
        }

        .status-legend {
            display: flex;
            gap: 20px;
            flex-wrap: wrap;
            margin-top: 20px;
            padding-top: 15px;
            border-top: 1px solid rgba(255,255,255,0.1);
            font-size: 0.85rem;
        }

        .legend-item {
            display: flex;
            align-items: center;
            gap: 8px;
        }

        .legend-dot {
            width: 12px;
            height: 12px;
            border-radius: 50%;
        }

        .legend-dot.healthy { background: #2ecc71; }
        .legend-dot.warning { background: #f1c40f; }
        .legend-dot.danger { background: #e74c3c; }

        @media (max-width: 768px) {
            .indicators-grid {
                grid-template-columns: 1fr;
            }

            h1 {
                font-size: 1.8rem;
            }

            .indicator-value {
                font-size: 2rem;
            }

            .guide-grid {
                grid-template-columns: 1fr;
            }
        }
    </style>
</head>
<body>
    <div class="container">
        <header>
            <h1>USA Economic Indicators Dashboard</h1>
            <p class="subtitle">Key financial stress indicators to monitor monthly</p>
        </header>

        <div class="reminder-banner">
            <span class="icon">üìÖ</span>
            <div>
                <strong>Monthly Review Reminder</strong>
                Check these indicators on the 1st of each month to track economic trends
            </div>
        </div>

        <p class="last-updated">Last refreshed: <span id="lastUpdated">Loading...</span></p>

        <div class="indicators-grid">
            <!-- Household Debt Service Ratio -->
            <div class="indicator-card">
                <div class="indicator-header">
                    <span class="indicator-title">Household Debt Service Ratio</span>
                    <span class="indicator-badge badge-quarterly">Quarterly</span>
                </div>
                <div class="indicator-value" id="dsr-value">Loading...</div>
                <div class="indicator-change" id="dsr-change">--</div>
                <div class="indicator-chart" id="dsr-chart"></div>
                <div class="indicator-meta">
                    <div class="meta-row">
                        <span>Latest Period:</span>
                        <span id="dsr-period">--</span>
                    </div>
                    <div class="meta-row">
                        <span>Series ID:</span>
                        <span>TDSP</span>
                    </div>
                    <div class="meta-row indicator-source">
                        <span>Source:</span>
                        <a href="https://fred.stlouisfed.org/series/TDSP" target="_blank">FRED - Federal Reserve</a>
                    </div>
                </div>
            </div>

            <!-- Auto Loan Delinquencies -->
            <div class="indicator-card">
                <div class="indicator-header">
                    <span class="indicator-title">Auto Loan Delinquencies (90+ Days)</span>
                    <span class="indicator-badge badge-quarterly">Quarterly</span>
                </div>
                <div class="indicator-value" id="auto-value">Loading...</div>
                <div class="indicator-change" id="auto-change">--</div>
                <div class="indicator-chart" id="auto-chart"></div>
                <div class="indicator-meta">
                    <div class="meta-row">
                        <span>Latest Period:</span>
                        <span id="auto-period">--</span>
                    </div>
                    <div class="meta-row">
                        <span>Measure:</span>
                        <span>% of Balance 90+ DPD</span>
                    </div>
                    <div class="meta-row indicator-source">
                        <span>Source:</span>
                        <a href="https://www.newyorkfed.org/microeconomics/hhdc" target="_blank">NY Fed Consumer Credit Panel</a>
                    </div>
                </div>
            </div>

            <!-- Credit Card Charge-offs -->
            <div class="indicator-card">
                <div class="indicator-header">
                    <span class="indicator-title">Credit Card Charge-off Rate</span>
                    <span class="indicator-badge badge-quarterly">Quarterly</span>
                </div>
                <div class="indicator-value" id="chargeoff-value">Loading...</div>
                <div class="indicator-change" id="chargeoff-change">--</div>
                <div class="indicator-chart" id="chargeoff-chart"></div>
                <div class="indicator-meta">
                    <div class="meta-row">
                        <span>Latest Period:</span>
                        <span id="chargeoff-period">--</span>
                    </div>
                    <div class="meta-row">
                        <span>Series ID:</span>
                        <span>CORCCACBS</span>
                    </div>
                    <div class="meta-row indicator-source">
                        <span>Source:</span>
                        <a href="https://fred.stlouisfed.org/series/CORCCACBS" target="_blank">FRED - Fed Banking Data</a>
                    </div>
                </div>
            </div>

            <!-- Unemployment Claims -->
            <div class="indicator-card">
                <div class="indicator-header">
                    <span class="indicator-title">Initial Unemployment Claims</span>
                    <span class="indicator-badge badge-weekly">Weekly</span>
                </div>
                <div class="indicator-value" id="claims-value">Loading...</div>
                <div class="indicator-change" id="claims-change">--</div>
                <div class="indicator-chart" id="claims-chart"></div>
                <div class="indicator-meta">
                    <div class="meta-row">
                        <span>Latest Week:</span>
                        <span id="claims-period">--</span>
                    </div>
                    <div class="meta-row">
                        <span>Series ID:</span>
                        <span>ICSA</span>
                    </div>
                    <div class="meta-row indicator-source">
                        <span>Source:</span>
                        <a href="https://fred.stlouisfed.org/series/ICSA" target="_blank">FRED - Dept of Labor</a>
                    </div>
                </div>
            </div>

            <!-- High Yield Credit Spreads -->
            <div class="indicator-card">
                <div class="indicator-header">
                    <span class="indicator-title">High Yield Credit Spread (ICE BofA)</span>
                    <span class="indicator-badge badge-daily">Daily</span>
                </div>
                <div class="indicator-value" id="spread-value">Loading...</div>
                <div class="indicator-change" id="spread-change">--</div>
                <div class="indicator-chart" id="spread-chart"></div>
                <div class="indicator-meta">
                    <div class="meta-row">
                        <span>Latest Date:</span>
                        <span id="spread-period">--</span>
                    </div>
                    <div class="meta-row">
                        <span>Series ID:</span>
                        <span>BAMLH0A0HYM2</span>
                    </div>
                    <div class="meta-row indicator-source">
                        <span>Source:</span>
                        <a href="https://fred.stlouisfed.org/series/BAMLH0A0HYM2" target="_blank">FRED - ICE BofA Index</a>
                    </div>
                </div>
            </div>
        </div>

        <div class="reading-guide">
            <h2>How to Read These Indicators</h2>
            <div class="guide-grid">
                <div class="guide-item">
                    <h3>Household Debt Service Ratio</h3>
                    <div class="guide-ranges">
                        <span class="range-healthy">&lt;10.5% Healthy</span>
                        <span class="range-warning">11-12% Stress</span>
                        <span class="range-danger">&gt;12% Recession risk</span>
                    </div>
                </div>
                <div class="guide-item">
                    <h3>Auto Loan Delinquencies (90+ Days)</h3>
                    <div class="guide-ranges">
                        <span class="range-healthy">&lt;2.5% Healthy</span>
                        <span class="range-warning">2.5-3.5% Stress</span>
                        <span class="range-danger">&gt;5% Crisis</span>
                    </div>
                </div>
                <div class="guide-item">
                    <h3>Credit Card Charge-off Rate</h3>
                    <div class="guide-ranges">
                        <span class="range-healthy">&lt;3.5% Healthy</span>
                        <span class="range-warning">3.5-4.5% Elevated</span>
                        <span class="range-danger">&gt;5% Recession</span>
                    </div>
                </div>
                <div class="guide-item">
                    <h3>Initial Unemployment Claims</h3>
                    <div class="guide-ranges">
                        <span class="range-healthy">&lt;250K Healthy</span>
                        <span class="range-warning">250-300K Softening</span>
                        <span class="range-danger">&gt;300K Recession</span>
                    </div>
                </div>
                <div class="guide-item">
                    <h3>High Yield Credit Spread</h3>
                    <div class="guide-ranges">
                        <span class="range-healthy">&lt;4% Healthy</span>
                        <span class="range-warning">4-6% Concern</span>
                        <span class="range-danger">&gt;8% Crisis</span>
                    </div>
                </div>
            </div>
            <div class="status-legend">
                <div class="legend-item"><span class="legend-dot healthy"></span> Healthy = Keep building steadily</div>
                <div class="legend-item"><span class="legend-dot warning"></span> Warning = Accelerate preparations</div>
                <div class="legend-item"><span class="legend-dot danger"></span> Danger = Execute defensive plan</div>
            </div>
        </div>

        <button class="refresh-btn" onclick="fetchAllData()">‚Üª Refresh All Data</button>

        <div class="data-sources">
            <h2>Data Sources & Direct Links</h2>
            <div class="sources-list">
                <div class="source-item">
                    <div class="source-icon">üè¶</div>
                    <div class="source-info">
                        <a href="https://fred.stlouisfed.org/" target="_blank">FRED (Federal Reserve Economic Data)</a>
                        <span>Primary source for DSR, Charge-offs, Claims, Spreads</span>
                    </div>
                </div>
                <div class="source-item">
                    <div class="source-icon">üèôÔ∏è</div>
                    <div class="source-info">
                        <a href="https://www.newyorkfed.org/microeconomics/hhdc" target="_blank">NY Fed Household Debt & Credit</a>
                        <span>Quarterly Report on Household Debt and Credit</span>
                    </div>
                </div>
                <div class="source-item">
                    <div class="source-icon">üíº</div>
                    <div class="source-info">
                        <a href="https://www.dol.gov/ui/data.pdf" target="_blank">Dept of Labor - UI Weekly Claims</a>
                        <span>Weekly unemployment insurance claims data</span>
                    </div>
                </div>
                <div class="source-item">
                    <div class="source-icon">üìä</div>
                    <div class="source-info">
                        <a href="https://www.federalreserve.gov/releases/chargeoff/" target="_blank">Fed Charge-off and Delinquency Rates</a>
                        <span>Quarterly delinquency rates on loans at commercial banks</span>
                    </div>
                </div>
            </div>
        </div>

        <footer>
            <p>Data fetched from FRED API and official government sources</p>
            <p style="margin-top: 10px;">Note: Some data series have reporting delays. Quarterly data typically released 6-8 weeks after quarter end.</p>
        </footer>
    </div>

    <script>
        // FRED API configuration
        // Note: For production use, you should get your own free API key from https://fred.stlouisfed.org/docs/api/api_key.html
        const FRED_API_KEY = '69d1fb421a592101969773bfb9f067a2'; // Replace with your FRED API key

        // Series IDs for FRED data
        const SERIES = {
            dsr: 'TDSP',           // Household Debt Service Ratio
            chargeoff: 'CORCCACBS', // Credit Card Charge-off Rate
            claims: 'ICSA',         // Initial Unemployment Claims
            spread: 'BAMLH0A0HYM2'  // High Yield Credit Spread
        };

        // Format number with commas
        function formatNumber(num, decimals = 2) {
            if (num >= 1000) {
                return num.toLocaleString('en-US', { maximumFractionDigits: 0 });
            }
            return num.toFixed(decimals);
        }

        // Calculate percentage change
        function calcChange(current, previous) {
            if (!previous) return { value: 0, text: 'N/A' };
            const change = ((current - previous) / previous) * 100;
            return {
                value: change,
                text: (change >= 0 ? '+' : '') + change.toFixed(2) + '%'
            };
        }

        // Render mini chart with Y-axis
        function renderChart(elementId, data, unit = '') {
            const container = document.getElementById(elementId);
            if (!container || !data || data.length === 0) return;

            container.innerHTML = '';
            const chartData = data.slice(-12);
            const max = Math.max(...chartData);
            const min = Math.min(...chartData);
            const range = max - min || 1;

            // Format axis values based on magnitude
            const formatAxisValue = (val) => {
                if (val >= 1000) return (val / 1000).toFixed(0) + 'K';
                if (val >= 100) return val.toFixed(0);
                if (val >= 10) return val.toFixed(1);
                return val.toFixed(2);
            };

            // Create Y-axis
            const yAxis = document.createElement('div');
            yAxis.className = 'chart-y-axis';
            yAxis.innerHTML = `
                <span>${formatAxisValue(max)}${unit}</span>
                <span>${formatAxisValue((max + min) / 2)}${unit}</span>
                <span>${formatAxisValue(min)}${unit}</span>
            `;
            container.appendChild(yAxis);

            // Create bars container
            const barsContainer = document.createElement('div');
            barsContainer.className = 'chart-bars';

            chartData.forEach(value => {
                const bar = document.createElement('div');
                bar.className = 'chart-bar';
                const height = ((value - min) / range) * 50 + 10;
                bar.style.height = height + 'px';
                barsContainer.appendChild(bar);
            });

            container.appendChild(barsContainer);
        }

        // Fetch data from FRED API
        async function fetchFredData(seriesId) {
            const url = `https://api.stlouisfed.org/fred/series/observations?series_id=${seriesId}&api_key=${FRED_API_KEY}&file_type=json&sort_order=desc&limit=20`;

            try {
                const response = await fetch(url);
                if (!response.ok) throw new Error('API request failed');
                const data = await response.json();
                return data.observations;
            } catch (error) {
                console.error(`Error fetching ${seriesId}:`, error);
                return null;
            }
        }

        // Update indicator display
        function updateIndicator(prefix, value, previousValue, period, unit = '%') {
            const valueEl = document.getElementById(`${prefix}-value`);
            const changeEl = document.getElementById(`${prefix}-change`);
            const periodEl = document.getElementById(`${prefix}-period`);

            if (valueEl) {
                if (unit === 'K') {
                    valueEl.textContent = formatNumber(value / 1000, 0) + 'K';
                } else if (unit === 'bps') {
                    valueEl.textContent = formatNumber(value, 2) + '%';
                } else {
                    valueEl.textContent = formatNumber(value) + unit;
                }
            }

            if (changeEl && previousValue) {
                const change = calcChange(value, previousValue);
                changeEl.textContent = `${change.text} from previous`;
                changeEl.className = 'indicator-change ' +
                    (change.value > 0 ? 'change-up' : change.value < 0 ? 'change-down' : 'change-neutral');
            }

            if (periodEl) {
                periodEl.textContent = period;
            }
        }

        // Load demonstration data (fallback when API key not configured)
        function loadDemoData() {
            // Household Debt Service Ratio (typically 9-11%)
            updateIndicator('dsr', 9.8, 9.7, 'Q3 2024', '%');
            renderChart('dsr-chart', [9.2, 9.3, 9.4, 9.5, 9.6, 9.5, 9.6, 9.7, 9.7, 9.8, 9.8, 9.8], '%');

            // Auto Loan Delinquencies (typically 2-4%)
            updateIndicator('auto', 3.2, 3.0, 'Q3 2024', '%');
            renderChart('auto-chart', [2.1, 2.2, 2.3, 2.5, 2.6, 2.7, 2.8, 2.9, 3.0, 3.1, 3.1, 3.2], '%');

            // Credit Card Charge-offs (typically 2-4%)
            updateIndicator('chargeoff', 4.19, 4.01, 'Q3 2024', '%');
            renderChart('chargeoff-chart', [2.5, 2.6, 2.8, 3.0, 3.2, 3.4, 3.6, 3.8, 3.9, 4.0, 4.1, 4.2], '%');

            // Initial Unemployment Claims (typically 200K-300K)
            updateIndicator('claims', 219000, 215000, 'Jan 25, 2025', 'K');
            renderChart('claims-chart', [210, 215, 218, 220, 225, 222, 218, 215, 212, 215, 218, 219], 'K');

            // High Yield Spread (typically 3-5%)
            updateIndicator('spread', 2.85, 2.92, 'Jan 30, 2025', 'bps');
            renderChart('spread-chart', [3.8, 3.6, 3.5, 3.4, 3.3, 3.2, 3.1, 3.0, 2.95, 2.9, 2.88, 2.85], '%');

            document.getElementById('lastUpdated').textContent = new Date().toLocaleString();
        }

        // Fetch all data
        async function fetchAllData() {
            const btn = document.querySelector('.refresh-btn');
            btn.disabled = true;
            btn.textContent = 'Loading...';

            if (FRED_API_KEY === '69d1fb421a592101969773bfb9f067a2') {
                console.log('No FRED API key configured. Using demonstration data.');
                console.log('Get your free API key at: https://fred.stlouisfed.org/docs/api/api_key.html');
                loadDemoData();
                btn.disabled = false;
                btn.textContent = '‚Üª Refresh All Data';
                return;
            }

            try {
                const [dsrData, chargeoffData, claimsData, spreadData] = await Promise.all([
                    fetchFredData(SERIES.dsr),
                    fetchFredData(SERIES.chargeoff),
                    fetchFredData(SERIES.claims),
                    fetchFredData(SERIES.spread)
                ]);

                if (dsrData && dsrData.length >= 2) {
                    const values = dsrData.map(d => parseFloat(d.value)).filter(v => !isNaN(v));
                    updateIndicator('dsr', values[0], values[1], dsrData[0].date, '%');
                    renderChart('dsr-chart', values.reverse(), '%');
                }

                if (chargeoffData && chargeoffData.length >= 2) {
                    const values = chargeoffData.map(d => parseFloat(d.value)).filter(v => !isNaN(v));
                    updateIndicator('chargeoff', values[0], values[1], chargeoffData[0].date, '%');
                    renderChart('chargeoff-chart', values.reverse(), '%');
                }

                if (claimsData && claimsData.length >= 2) {
                    const values = claimsData.map(d => parseFloat(d.value)).filter(v => !isNaN(v));
                    updateIndicator('claims', values[0], values[1], claimsData[0].date, 'K');
                    renderChart('claims-chart', values.map(v => v/1000).reverse(), 'K');
                }

                if (spreadData && spreadData.length >= 2) {
                    const values = spreadData.map(d => parseFloat(d.value)).filter(v => !isNaN(v));
                    updateIndicator('spread', values[0], values[1], spreadData[0].date, 'bps');
                    renderChart('spread-chart', values.reverse(), '%');
                }

                document.getElementById('lastUpdated').textContent = new Date().toLocaleString();

            } catch (error) {
                console.error('Error fetching data:', error);
                loadDemoData();
            }

            btn.disabled = false;
            btn.textContent = '‚Üª Refresh All Data';
        }

        document.addEventListener('DOMContentLoaded', fetchAllData);
    </script>
</body>
</html>
